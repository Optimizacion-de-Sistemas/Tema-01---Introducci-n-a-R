<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ignacio González González">

<title>Tema 01 - Introducción a R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Tema 01 - Introducción a R_files/libs/clipboard/clipboard.min.js"></script>
<script src="Tema 01 - Introducción a R_files/libs/quarto-html/quarto.js"></script>
<script src="Tema 01 - Introducción a R_files/libs/quarto-html/popper.min.js"></script>
<script src="Tema 01 - Introducción a R_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Tema 01 - Introducción a R_files/libs/quarto-html/anchor.min.js"></script>
<link href="Tema 01 - Introducción a R_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Tema 01 - Introducción a R_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Tema 01 - Introducción a R_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Tema 01 - Introducción a R_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Tema 01 - Introducción a R_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Tema 01 - Introducción a R.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tema 01 - Introducción a R</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ignacio González González </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="pregunta-1-20-puntos" class="level2">
<h2 class="anchored" data-anchor-id="pregunta-1-20-puntos">Pregunta 1 (20 puntos)</h2>
<p>Construya una función que contenga 2 argumentos, que genere un valor “n” de participaciones de la lotería primitiva y obtenga el número total de esas participaciones que contengan algún número en el vector “v” facilitado en la función. La función debe devolver las “n” participaciones y el número total referido anteriormente. Fije la semilla del generador aleatorio al valor: 1234.</p>
<ol type="1">
<li>Utilice la función con <span class="math inline">\(n=5000\)</span> y con el vector: “1,2,3,4,5,47,48,49”. Guarde todas las participaciones en un fichero RData.</li>
</ol>
<p>Para las participaciones del apartado 1.</p>
<ol type="a">
<li>Obtenga el valor que más veces ha aparecido y el que menos ha aparecido.</li>
<li>Obtenga la pareja de valores que más veces ha aparecido de forma simultánea.</li>
<li>Obtenga las 3 observaciones más pequeñas de cada participación y muestre aquellas que se han repetido más de 2 veces.</li>
</ol>
<hr>
<p>Para resolver el apartado 1, se define una función llamada “loteria.primitiva” que simula el juego de la primitiva. Se utiliza un bucle “for” para crear todas las participaciones utilizando el método “sample()”, que genera números aleatorios. Dentro de este bucle, se verifica si cada participación creada contiene algún número premiado mediante otro bucle “for” y una condición “if” con “%in%” para comprobar la presencia de los números premiados en la participación. Una vez creadas todas las participaciones, se guarda el resultado haciendo uso de la función “save()” y se devuelve el número de participaciones premiadas mediante “return”. Por último, para cargar los datos, hacemos uso de la función “load()”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>loteria.primitiva <span class="ot">&lt;-</span> <span class="cf">function</span>(num.participaciones, num.buscar){</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  total.con.premio <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  participaciones <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="at">length =</span> num.participaciones)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num.participaciones){</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    participacion <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">49</span>, <span class="dv">8</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    participaciones[[i]] <span class="ot">&lt;-</span> participacion</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (num <span class="cf">in</span> num.buscar) {</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (num <span class="sc">%in%</span> participacion){</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        total.con.premio <span class="ot">&lt;-</span> total.con.premio <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">save</span>(participaciones, <span class="at">file =</span> <span class="st">"participaciones.RData"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (total.con.premio)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>num.buscar <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">47</span>,<span class="dv">48</span>,<span class="dv">49</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>total.con.premio <span class="ot">&lt;-</span> <span class="fu">loteria.primitiva</span>(<span class="dv">5000</span>, num.buscar)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"participaciones.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 28 16 22 37 44  9  5 38

[[2]]
[1] 16  4 34 39 22 26  6 15

[[3]]
[1] 14 49  4 47 21 40 20  3

[[4]]
[1] 36 31 29  5  2 40 20  3

[[5]]
[1] 23 41 36  8 32 42 43  2

[[6]]
[1] 15 38  6 29 32  8 26 17</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>El número de veces que aparece algún número del vector  1 2 3 4 5 47 48 49 es:  3938</code></pre>
</div>
</div>
<p>Para resolver el apartado a, se crea la función “valores.frecuentes()”, a la cual se le introducen las participaciones como argumento. Esta función utiliza tres bucles “for”:</p>
<ol type="1">
<li><p>El primer bucle “for” inicializa un vector de frecuencias, estableciendo inicialmente todos los valores en 0.</p></li>
<li><p>El segundo bucle “for” recorre todas las participaciones y tiene un bucle “for” anidado que itera sobre cada valor dentro de cada participación. Este bucle actualiza el vector de frecuencias contando cuántas veces aparece cada valor en todas las participaciones.</p></li>
<li><p>Finalmente, otro bucle “for” recorre el vector de frecuencias para encontrar el valor máximo y el mínimo.</p></li>
</ol>
<p>La función devuelve un vector con el valor máximo, el valor mínimo y el vector de frecuencias actualizado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>valores.frecuentes <span class="ot">&lt;-</span> <span class="cf">function</span>(participaciones){</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  frecuencias <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="at">length =</span> <span class="dv">49</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  menor <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  mayor <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  menores <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  mayores <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">49</span>){</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    frecuencias[[i]] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> participaciones){</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> i){</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>      frecuencias[[j]] <span class="ot">&lt;-</span> frecuencias[[j]] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">49</span>){</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (menor <span class="sc">==</span> frecuencias[[i]]){</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>      menores[[<span class="fu">length</span>(menores) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> i</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (mayor <span class="sc">==</span> frecuencias[[i]]){</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>      mayores[[<span class="fu">length</span>(mayores) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> i</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (menor <span class="sc">&gt;</span> frecuencias[[i]]){</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>      menores <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>      menores[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> i</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>      menor <span class="ot">&lt;-</span> frecuencias[[i]]</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (mayor <span class="sc">&lt;</span> frecuencias[[i]]){</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>      mayores <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>      mayores[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> i</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>      mayor <span class="ot">&lt;-</span> frecuencias[[i]]</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">c</span>(<span class="at">menor =</span> menor, <span class="at">menores =</span> menores, <span class="at">mayor =</span> mayor, <span class="at">mayores =</span> mayores))</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Menor frecuencia: 766 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Números con menor frecuencia: 14 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Mayor frecuencia: 869 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Números con mayor frecuencia: 13 </code></pre>
</div>
</div>
<p>Para resolver el apartado b, se crea la función “pares.mas.repetidos()”, que recibe como parámetro de entrada las participaciones y devuelve un vector con las frecuencias de aparición, el número de apariciones y los valores mayores.</p>
<p>Aquí está el proceso en resumen:</p>
<ol type="1">
<li><p>Se crea un dataframe para almacenar cada par posible de valores de entre los 49 números de la primitiva y el número de apariciones que tiene ese par.</p></li>
<li><p>Se utiliza un bucle “for” para recorrer todas las participaciones. Dentro de este bucle, se ordenan los valores de cada participación utilizando el método “sort()” y se obtiene la longitud de la participación con “length()”.</p></li>
<li><p>Se utiliza otro bucle “for” para recorrer todos los valores de la participación menos el último, ya que no puede tener pareja superior. Dentro de este bucle, se itera sobre las parejas posibles de cada participación y se utiliza el método “which” para verificar si la pareja está contemplada en el dataframe creado anteriormente. Si la pareja existe en el dataframe, se incrementa su conteo en 1, de lo contrario, se agrega la pareja al dataframe con un conteo inicial de 1.</p></li>
<li><p>Una vez que se tienen todas las parejas y sus frecuencias, se utiliza el método “max()” para obtener la mayor frecuencia y se filtran las parejas que tienen esa frecuencia, por si existe más de una pareja con esa frecuencia.</p></li>
<li><p>Finalmente, se devuelve un vector con las frecuencias de aparición, el número de apariciones y los valores mayores de las parejas más repetidas</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pares.mas.repetidos <span class="ot">&lt;-</span> <span class="cf">function</span>(participaciones){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    mayor <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    mayores <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  frecuencias <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">parejas =</span> <span class="fu">paste</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">48</span>, <span class="at">by =</span> <span class="dv">1</span>), <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">49</span>, <span class="at">by =</span> <span class="dv">1</span>), <span class="at">sep =</span> <span class="st">","</span>),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">repeticiones =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="at">length =</span> <span class="dv">24</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (particion <span class="cf">in</span> participaciones) {</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    particion <span class="ot">&lt;-</span> <span class="fu">sort</span>(particion)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    longitud <span class="ot">&lt;-</span> <span class="fu">length</span>(particion)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (num <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(longitud <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>      pareja <span class="ot">&lt;-</span> <span class="fu">c</span>(particion[num], particion[num <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>      index <span class="ot">&lt;-</span> <span class="fu">which</span>(frecuencias<span class="sc">$</span>parejas <span class="sc">==</span> <span class="fu">paste</span>(pareja, <span class="at">collapse =</span> <span class="st">","</span>))</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>      frecuencias<span class="sc">$</span>repeticiones[index] <span class="ot">&lt;-</span> frecuencias<span class="sc">$</span>repeticiones[index] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  mayor <span class="ot">&lt;-</span> <span class="fu">max</span>(frecuencias<span class="sc">$</span>repeticiones)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  mayores <span class="ot">&lt;-</span> frecuencias<span class="sc">$</span>parejas[frecuencias<span class="sc">$</span>repeticiones <span class="sc">==</span> mayor]</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">c</span>(<span class="at">frecuencias =</span> frecuencias, <span class="at">mayor =</span> mayor, <span class="at">mayores =</span> <span class="fu">unlist</span>(mayores)))</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Mayor frecuencia: 141 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Pares con mayor frecuencia: 23,24 </code></pre>
</div>
</div>
<p>Para el apartado c, se crea la función “particiones.mas.pequenas()”, que toma como entrada las participaciones y devuelve un vector con todas las participaciones más pequeñas con una frecuencia mayor a dos.</p>
<ol type="1">
<li><p>Se utiliza un bucle “for” para iterar sobre todas las participaciones.</p></li>
<li><p>Dentro del bucle, se ordenan las participaciones utilizando el método “sort” y se seleccionan las tres primeras mediante “[1:3]”, ya que estas serán las más pequeñas.</p></li>
<li><p>Se crea una clave para cada partición con el método “paste”, que une los tres valores mínimos de cada participación separados por comas.</p></li>
<li><p>Se utiliza una estructura condicional “if else” para verificar si la clave ya está contemplada. Si lo está, se incrementa su frecuencia, de lo contrario, se añade la clave con una frecuencia inicial de 1.</p></li>
<li><p>Finalmente, se devuelve un vector con todas las participaciones más pequeñas con una frecuencia mayor a dos.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>particiones.mas.pequenas <span class="ot">&lt;-</span> <span class="cf">function</span>(participaciones){</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  frecuencias <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (particion <span class="cf">in</span> participaciones){</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    menores <span class="ot">&lt;-</span> <span class="fu">sort</span>(particion)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    clave <span class="ot">&lt;-</span> <span class="fu">paste</span>(menores, <span class="at">collapse =</span> <span class="st">","</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (clave <span class="sc">%in%</span> <span class="fu">names</span>(frecuencias)){</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>      frecuencias[clave] <span class="ot">&lt;-</span> frecuencias[clave] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>      frecuencias[clave] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  filtro <span class="ot">&lt;-</span> <span class="fu">subset</span>(frecuencias, frecuencias <span class="sc">&gt;</span> <span class="dv">2</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(filtro)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Se han detectado un total de  603  participaciones más pequeñas con frecuencia mayor a 2:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Algunas de las participaciones son: </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Partición: 5,9,16 - Frecuencia: 5 
Partición: 4,6,15 - Frecuencia: 3 
Partición: 2,3,5 - Frecuencia: 13 
Partición: 6,8,15 - Frecuencia: 7 
Partición: 3,8,16 - Frecuencia: 3 
Partición: 1,8,9 - Frecuencia: 11 
Partición: 6,17,21 - Frecuencia: 4 
Partición: 2,6,11 - Frecuencia: 4 
Partición: 6,9,21 - Frecuencia: 3 
Partición: 6,15,19 - Frecuencia: 3 
Partición: 7,9,14 - Frecuencia: 4 
Partición: 4,7,17 - Frecuencia: 3 
Partición: 3,9,12 - Frecuencia: 5 
Partición: 4,6,7 - Frecuencia: 8 
Partición: 8,12,20 - Frecuencia: 3 
Partición: 3,6,11 - Frecuencia: 3 </code></pre>
</div>
</div>
<hr>
</section>
<section id="pregunta-2-20-puntos" class="level2">
<h2 class="anchored" data-anchor-id="pregunta-2-20-puntos">Pregunta 2 (20 puntos)</h2>
<p>Con los siguientes dos datasets (data.frames):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6543</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,<span class="dv">20</span>),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Alturamm =</span> <span class="fu">rnorm</span>(<span class="dv">2000</span>,<span class="dv">170</span>,<span class="dv">10</span>),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">PesoKg =</span> <span class="fu">rnorm</span>(<span class="dv">2000</span>,<span class="dv">65</span>,<span class="dv">3</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sexo =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Hombre"</span>,<span class="st">"Mujer"</span>),<span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Edad =</span> <span class="fu">sample</span>(<span class="dv">18</span><span class="sc">:</span><span class="dv">45</span>,<span class="dv">100</span>,<span class="at">replace =</span> <span class="cn">TRUE</span>) </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="a">
<li>Una o fusione los dos datasets o tablas utilizando el identificador “Id” que relaciona las dos tablas. Obtenga tanto el registro que tiene mayor altura como el registro que tiene menor peso, e indique que edad y sexo tienen.</li>
<li>Calcule la media de los pesos para los hombres y para las mujeres por separado. Igual para las alturas.</li>
<li>Calcule cuántos hombres hay que tengan una edad entre 25 y 30 años (ambas incluidas) con una altura superior a 173mm o un peso menor que 64kg.</li>
<li>Grabe en un fichero RData el dataset fusionado y los dos datsets iniciales.</li>
<li>Construya una función de 3 argumentos que devuelva dos datasets con una estructura semejante a los dados anteriormente, pero que se generen al facilitarle una “semilla”, un número “n” de personas (en el dado anteriormente se han generado para n=100 personas), y el vector con las edades de las personas “vedades”. Utilice la función con semilla: 78, número de personas 200 y vector de edades de 14 a 50, y sobre esos datasets responda al apartado c.</li>
</ol>
<hr>
<p>Para resolver el apartado a, creamos la función ‘union.data.frame()’ que recibe como parámetros de entrada dos dataframes y los une utilizando la ‘id’ de los mismos. Una vez que tenemos el dataframe unido, con el método ‘which.max()’ buscamos cuál es la altura máxima y con ‘which.min()’ buscamos el peso mínimo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>union.data.frame <span class="ot">&lt;-</span> <span class="cf">function</span>(data1, data2){</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">merge</span>(data1, data2, <span class="at">by.x=</span><span class="st">"Id"</span>, <span class="at">by.y=</span><span class="st">"Id"</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>resultado.union <span class="ot">=</span> <span class="fu">union.data.frame</span>(df1, df2)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>mayor.altura <span class="ot">&lt;-</span> <span class="fu">which.max</span>(resultado.union<span class="sc">$</span>Alturamm)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>menor.peso <span class="ot">&lt;-</span> <span class="fu">which.min</span>(resultado.union<span class="sc">$</span>PesoKg)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>registro.mayor.altura <span class="ot">&lt;-</span> resultado.union[mayor.altura, ]</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>registro.menor.peso <span class="ot">&lt;-</span> resultado.union[menor.peso, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  Id Alturamm   PesoKg   Sexo Edad
1  1 176.5345 64.14632 Hombre   45
2  1 175.6372 64.90283 Hombre   45
3  1 158.1014 63.36265 Hombre   45
4  1 162.9749 67.72423 Hombre   45
5  1 164.2141 65.10229 Hombre   45
6  1 174.9892 69.89997 Hombre   45</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Registro con mayor altura y menor peso:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Registro con mayor altura:  95 con altura de:  204.020318925194 , con una edad de:  27 
 y de sexo:  Mujer</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     Id Alturamm  PesoKg  Sexo Edad
1898 95 204.0203 63.9578 Mujer   27</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Registro con menor peso:  66 con un peso de:  53.8646458533667 con una edad de:  22 
 y de sexo:  Hombre</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     Id Alturamm   PesoKg   Sexo Edad
1311 66  184.666 53.86465 Hombre   22</code></pre>
</div>
</div>
<p>Para el apartado b creamos la función ‘media.peso.y.altura()’ que recibe como parámetro un dataframe y devuelve un vector con la media de peso y altura en función del sexo.</p>
<p>Con un bucle ‘for’, recorremos todas las filas del dataframe. Dentro de este bucle, utilizamos un ‘if’ para filtrar el sexo y luego realizamos un sumatorio de las alturas y los pesos. Una vez que hemos recorrido todas las filas, dividimos estos sumatorios por el total de hombres o mujeres, según corresponda.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>media.peso.y.altura <span class="ot">&lt;-</span> <span class="cf">function</span>(resultado.union){</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  hombres <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  altura.hombre <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  peso.hombre <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  mujeres <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  altura.mujer <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  peso.mujer <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(resultado.union)){</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    registro <span class="ot">&lt;-</span> resultado.union[i, ]</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (registro<span class="sc">$</span>Sexo <span class="sc">==</span> <span class="st">"Hombre"</span>){</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>      hombres <span class="ot">&lt;-</span> hombres <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>      altura.hombre <span class="ot">&lt;-</span> altura.hombre <span class="sc">+</span> registro<span class="sc">$</span>Alturamm</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>      peso.hombre <span class="ot">&lt;-</span> peso.hombre <span class="sc">+</span> registro<span class="sc">$</span>PesoKg</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (registro<span class="sc">$</span>Sexo <span class="sc">==</span> <span class="st">"Mujer"</span>) {</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>      mujeres <span class="ot">&lt;-</span> mujeres <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>      altura.mujer <span class="ot">&lt;-</span> altura.mujer <span class="sc">+</span> registro<span class="sc">$</span>Alturamm</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>      peso.mujer <span class="ot">&lt;-</span> peso.mujer <span class="sc">+</span> registro<span class="sc">$</span>PesoKg</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  altura.hombre <span class="ot">&lt;-</span> altura.hombre <span class="sc">/</span> hombres</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  peso.hombre <span class="ot">&lt;-</span> peso.hombre <span class="sc">/</span> hombres</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  altura.mujer <span class="ot">&lt;-</span> altura.mujer <span class="sc">/</span> mujeres</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  peso.mujer <span class="ot">&lt;-</span> peso.mujer <span class="sc">/</span> mujeres</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(altura.hombre, peso.hombre, altura.mujer, peso.mujer))</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Media de altura para hombres: 169.9189 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Media de peso para hombres: 65.03668 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Media de altura para mujeres: 170.3753 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Media de peso para mujeres: 65.06936 </code></pre>
</div>
</div>
<p>Para el apartado c, haciendo uso del método ‘subset’, filtramos con los parámetros que nos indica el enunciado y luego, con el método ‘nrow’, contamos cuántas filas hay.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>filtro <span class="ot">&lt;-</span> <span class="fu">subset</span>(resultado.union, Sexo <span class="sc">==</span> <span class="st">"Hombre"</span> <span class="sc">&amp;</span> (Edad <span class="sc">&gt;=</span> <span class="dv">25</span> <span class="sc">&amp;</span> Edad <span class="sc">&lt;=</span> <span class="dv">30</span>) <span class="sc">&amp;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                   (Alturamm <span class="sc">&gt;</span> <span class="dv">173</span> <span class="sc">|</span> PesoKg <span class="sc">&lt;</span> <span class="dv">64</span>))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>cantidad.filtrada <span class="ot">&lt;-</span> <span class="fu">nrow</span>(filtro)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Número de hombres con edad entre 25 y 30 años, altura superior a 173mm o 
 peso menor que 64kg: 189 </code></pre>
</div>
</div>
<p>En el apartado d, utilizamos el método “save” para guardar el dataframe fusionado y luego, haciendo uso del método “load”, lo cargamos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(df1, df2, resultado.union, <span class="at">file =</span> <span class="st">"datasets_fusionado.RData"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"datasets_fusionado.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  Id Alturamm   PesoKg
1  1 176.5345 64.14632
2  2 139.8244 63.54356
3  3 167.4759 65.15801
4  4 166.5576 65.27144
5  5 180.2236 68.16254
6  6 161.0694 64.42808</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Id   Sexo Edad
1  1 Hombre   45
2  2  Mujer   40
3  3 Hombre   39
4  4  Mujer   35
5  5 Hombre   21
6  6 Hombre   39</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Id Alturamm   PesoKg   Sexo Edad
1  1 176.5345 64.14632 Hombre   45
2  1 175.6372 64.90283 Hombre   45
3  1 158.1014 63.36265 Hombre   45
4  1 162.9749 67.72423 Hombre   45
5  1 164.2141 65.10229 Hombre   45
6  1 174.9892 69.89997 Hombre   45</code></pre>
</div>
</div>
<p>En el apartado e, creamos la función “generar.datasets()” que tiene como entrada la semilla, un número de personas y un vector de edades. Esta función genera los dos dataframes y los coloca en una lista.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>generar.datasets <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">seed =</span> <span class="dv">78</span>, <span class="at">n =</span> <span class="dv">200</span>, <span class="at">vedades =</span> <span class="dv">14</span><span class="sc">:</span><span class="dv">50</span>){</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  df1.generado <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>(n<span class="sc">/</span><span class="dv">20</span>),<span class="dv">20</span>),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Alturamm =</span> <span class="fu">rnorm</span>(n,<span class="dv">170</span>,<span class="dv">10</span>),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">PesoKg =</span> <span class="fu">rnorm</span>(n,<span class="dv">65</span>,<span class="dv">3</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  df2.generado <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Id =</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">/</span><span class="dv">20</span>),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sexo =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Hombre"</span>,<span class="st">"Mujer"</span>),n<span class="sc">/</span><span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Edad =</span> <span class="fu">sample</span>(vedades,n<span class="sc">/</span><span class="dv">20</span>,<span class="at">replace =</span> <span class="cn">TRUE</span>) </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(df1.generado, df2.generado))</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  Id Alturamm   PesoKg
1  1 177.1728 67.38487
2  2 172.5815 67.28853
3  3 180.7506 65.74062
4  4 164.6242 62.34480
5  5 156.7356 62.62566
6  6 181.8173 66.05913</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Id   Sexo Edad
1  1 Hombre   18
2  2  Mujer   49
3  3  Mujer   48
4  4  Mujer   48
5  5 Hombre   41
6  6 Hombre   49</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Número de hombres con edad entre 25 y 30 años, altura superior a 173mm o 
 peso menor que 64kg: 0</code></pre>
</div>
</div>
<hr>
</section>
<section id="pregunta-3-20-puntos" class="level2">
<h2 class="anchored" data-anchor-id="pregunta-3-20-puntos">Pregunta 3 (20 puntos)</h2>
<p>Cree una función que tenga como argumentos:</p>
<p>- Una función cualquiera con un único argumento y que devuelva un único valor numérico.</p>
<p>- Un vector de valores.</p>
<p>Con estos argumentos genere un gráfico de líneas con la representación de la función. Añadirle a la función también algunos argumentos con valor por defecto, en los que se pueda especificar: el título, el color de la línea y el grosor. Pruebe la función creando dos gráficos para dos funciones distintas, una de ellas debe crearla.</p>
<hr>
<p>Creamamos la función “representacion.grafica()” a la cual le entran como parámetros de entrada obligatorios una función y los valores que tendrán en el eje x. Utilizamos el método “sapply” para obtener los valores del eje y evaluando esta función en los valores del eje x. Posteriormente, con el método “plot”, representamos el gráfico.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>representacion.grafica <span class="ot">&lt;-</span> <span class="cf">function</span>(funcion, valores_x, </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">titulo =</span> <span class="st">"Representación Gráfica"</span>, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">grosor =</span> <span class="dv">1</span>){</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  valores_y <span class="ot">&lt;-</span> <span class="fu">sapply</span>(valores_x, funcion)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(valores_x, </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>       valores_y, <span class="at">type=</span><span class="st">"l"</span>, </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span>titulo, </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span>color, </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd=</span>grosor, </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim =</span> <span class="fu">range</span>(valores_y))</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>cuadrado <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>seno <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sin</span>(x))</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>otra <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x<span class="sc">^</span><span class="dv">2-8</span><span class="sc">*</span>x<span class="sc">+</span><span class="dv">200</span>)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>valores <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="fu">representacion.grafica</span>(<span class="at">funcion =</span> cuadrado, <span class="at">valores_x =</span> valores, <span class="at">titulo =</span> <span class="st">"Función Cuadrado de un número"</span>, <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">grosor =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Tema-01---Introducción-a-R_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">expression</span>(x<span class="sc">^</span><span class="dv">2-2</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">5</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>ffun <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">eval</span>(f)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">representacion.grafica</span>(<span class="at">funcion =</span> ffun, <span class="at">valores_x =</span> valores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Tema-01---Introducción-a-R_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
</section>
<section id="pregunta-4-20-puntos" class="level2">
<h2 class="anchored" data-anchor-id="pregunta-4-20-puntos">Pregunta 4 (20 puntos)</h2>
<p>Invente un ejercicio en el que se utilicen los diferentes tipos de funciones “apply” que se han visto en clase.</p>
<hr>
<p>Generamos un dataframe llamado “ventas”, el cual simula un conjunto de datos de ventas. Realizamos diferentes cálculos estadísticos y de precios con esos datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>ventas <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tienda =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Mercadona"</span>, <span class="st">"Carrefour"</span>, <span class="st">"Jamón"</span>), <span class="dv">15</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">producto =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Coca-cola"</span>, <span class="st">"Cerveza"</span>, <span class="st">"Jamón"</span>), <span class="dv">15</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mes =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Enero"</span>, <span class="st">"Febrero"</span>, <span class="st">"Marzo"</span>, <span class="st">"Abril"</span>, <span class="st">"Mayo"</span>), <span class="dv">15</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ventas =</span> <span class="fu">sample</span>(<span class="dv">100</span><span class="sc">:</span><span class="dv">500</span>, <span class="dv">15</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>resultados_lapply <span class="ot">&lt;-</span> </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="fu">split</span>(ventas<span class="sc">$</span>ventas, <span class="fu">list</span>(ventas<span class="sc">$</span>tienda, ventas<span class="sc">$</span>producto)), mean)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>resultados_sapply <span class="ot">&lt;-</span> </span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(<span class="fu">split</span>(ventas<span class="sc">$</span>ventas, <span class="fu">list</span>(ventas<span class="sc">$</span>tienda, ventas<span class="sc">$</span>mes)), sum)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>resultados_apply <span class="ot">&lt;-</span> </span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(<span class="fu">table</span>(ventas<span class="sc">$</span>producto, ventas<span class="sc">$</span>mes), <span class="dv">1</span>, max)</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>resultados_tapply <span class="ot">&lt;-</span> </span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tapply</span>(ventas<span class="sc">$</span>ventas, <span class="fu">list</span>(ventas<span class="sc">$</span>tienda, ventas<span class="sc">$</span>producto), sum)</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>precios_unitarios <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Coca-cola"</span> <span class="ot">=</span> <span class="fl">1.5</span>, <span class="st">"Cerveza"</span> <span class="ot">=</span> <span class="fl">2.0</span>, <span class="st">"Jamón"</span> <span class="ot">=</span> <span class="fl">10.0</span>)</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>calcular_precio_total <span class="ot">&lt;-</span> <span class="cf">function</span>(ventas, precio_unitario) {</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ventas <span class="sc">*</span> precio_unitario)</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>resultados_mapply <span class="ot">&lt;-</span> </span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mapply</span>(calcular_precio_total, ventas<span class="sc">$</span>ventas,</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>         precios_unitarios[ventas<span class="sc">$</span>producto])</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>ventas_nuevo <span class="ot">&lt;-</span> ventas</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>ventas_nuevo<span class="sc">$</span>precio_total <span class="ot">&lt;-</span> resultados_mapply</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Creamos el dataframe Ventas:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     tienda  producto     mes ventas
1 Carrefour   Cerveza Febrero    203
2 Carrefour     Jamón   Abril    232
3     Jamón Coca-cola   Abril    310
4     Jamón Coca-cola   Marzo    184
5 Carrefour     Jamón   Abril    351
6 Mercadona   Cerveza   Abril    157</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Resultado utilizando lapply. Promedio de ventas por tienda y producto:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$Carrefour.Cerveza
[1] 151.3333

$Jamón.Cerveza
[1] NaN

$Mercadona.Cerveza
[1] 218

$`Carrefour.Coca-cola`
[1] 333

$`Jamón.Coca-cola`
[1] 227

$`Mercadona.Coca-cola`
[1] 138

$Carrefour.Jamón
[1] 294.3333

$Jamón.Jamón
[1] NaN

$Mercadona.Jamón
[1] 315</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Resultado utilizando sapply. Suma de ventas mensuales por tienda y mes:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Carrefour.Abril       Jamón.Abril   Mercadona.Abril Carrefour.Febrero 
              966               310               436               203 
    Jamón.Febrero Mercadona.Febrero   Carrefour.Marzo       Jamón.Marzo 
                0                 0               422               371 
  Mercadona.Marzo    Carrefour.Mayo        Jamón.Mayo    Mercadona.Mayo 
                0               412                 0               453 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Resultado utilizando apply. Productos en tienda:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Cerveza Coca-cola     Jamón 
        2         3         2 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Resultado utilizando tapply. Total de ventas por mes:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>          Cerveza Coca-cola Jamón
Carrefour     454       666   883
Jamón          NA       681    NA
Mercadona     436       138   315</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Resultado utilizando mapply. Precio total de ventas por tienda y producto:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     tienda  producto     mes ventas precio_total
1 Carrefour   Cerveza Febrero    203          406
2 Carrefour     Jamón   Abril    232         2320
3     Jamón Coca-cola   Abril    310          465
4     Jamón Coca-cola   Marzo    184          276
5 Carrefour     Jamón   Abril    351         3510
6 Mercadona   Cerveza   Abril    157          314</code></pre>
</div>
</div>
<hr>
</section>
<section id="pregunta-5-20-puntos" class="level2">
<h2 class="anchored" data-anchor-id="pregunta-5-20-puntos">Pregunta 5 (20 puntos)</h2>
<p>Invente un ejercicio en el que utilice el mayor número posible de elementos vistos en el tema de introducción a R.</p>
<hr>
<p>Generamos un dataframe llamado “encuestas”, el cual contiene los resultados a tres preguntas, y estos son analizados con distintos métodos como “max” y “mean”, además de utilizar un bucle “while”, el método “table” para crear una matriz y una representación gráfica utilizando el método “barplot”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>encuestas <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">edad =</span> <span class="fu">sample</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">65</span>, <span class="dv">15</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sexo =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Hombre"</span>, <span class="st">"Mujer"</span>), <span class="dv">15</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pregunta.1 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">15</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pregunta.2 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">15</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">pregunta.3 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Si"</span>, <span class="st">"No"</span>), <span class="dv">15</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>edad.maxima <span class="ot">&lt;-</span> <span class="fu">max</span>(encuestas<span class="sc">$</span>edad)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>edad.minima <span class="ot">&lt;-</span> <span class="fu">min</span>(encuestas<span class="sc">$</span>edad)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>media.p1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(encuestas<span class="sc">$</span>pregunta<span class="fl">.1</span>)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>mediana.p1 <span class="ot">&lt;-</span> <span class="fu">median</span>(encuestas<span class="sc">$</span>pregunta<span class="fl">.1</span>)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>edad.p2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (i <span class="sc">&lt;=</span> <span class="fu">nrow</span>(encuestas)){</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  registro <span class="ot">&lt;-</span> encuestas[i, ]</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (registro<span class="sc">$</span>edad <span class="sc">&lt;</span> <span class="dv">18</span>){</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (registro<span class="sc">$</span>pregunta<span class="fl">.2</span> <span class="sc">&gt;=</span> <span class="dv">5</span>){</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>      edad.p2[<span class="dv">1</span>] <span class="ot">&lt;-</span> edad.p2[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>      edad.p2[<span class="dv">2</span>] <span class="ot">&lt;-</span> edad.p2[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (registro<span class="sc">$</span>pregunta<span class="fl">.2</span> <span class="sc">&gt;=</span> <span class="dv">5</span>){</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>      edad.p2[<span class="dv">3</span>] <span class="ot">&lt;-</span> edad.p2[<span class="dv">3</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>      edad.p2[<span class="dv">4</span>] <span class="ot">&lt;-</span> edad.p2[<span class="dv">4</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>matriz.sexo.p3 <span class="ot">&lt;-</span> <span class="fu">table</span>(encuestas<span class="sc">$</span>sexo, encuestas<span class="sc">$</span>pregunta<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  edad   sexo pregunta.1 pregunta.2 pregunta.3
1   28 Hombre          8          8         Si
2   53  Mujer          3          5         Si
3   20  Mujer         10          8         No
4   27  Mujer          2          7         Si
5   29 Hombre          6          9         No
6   23  Mujer          1          8         No</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Edad máxima:  55 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Edad mínima:  15 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>La media de la respuesta 1 ha sido de:  5.6 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>La mediana de la respuesta 1 ha sido de:  7 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Ecuestados menores de edad que han respondido en respuesta 2 mayor de 5:  1 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Ecuestados menores de edad que han respondido en respuesta 2 menor de 5:  0 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Ecuestados mayores de edad que han respondido en respuesta 2 mayor de 5:  10 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Ecuestados mayores de edad que han respondido en respuesta 2 menor de 5:  10 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Representación por sexo y pregunta.3: </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        
         No Si
  Hombre  3  2
  Mujer   2  8</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Tema-01---Introducción-a-R_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>